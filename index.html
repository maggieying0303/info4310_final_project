<!DOCTYPE html>
<html lang = "en">
<head>
  <meta charset="UTF-8" />
  <link rel="shortcut icon" href="#"/>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://d3js.org/topojson.v2.min.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/all.css" media="all" />

  <title>Final Project</title>
</head>

<body>

  <h1>Number of _____ Movies Available on Streaming Platforms</h1>

  <svg width=600 height=400 id="barchart"></svg>

  <script>

  let allLayer = d3.select("#barchart").append("g");
  let allWidth = d3.select("#barchart").attr("width");
  let allHeight = d3.select("#barchart").attr("height");

  const requestData = async function() {

    //reading data

    const movies_netflix = await d3.csv("datasets/movies_netflix.csv");
    console.log(movies_netflix);

    const movies_hulu = await d3.csv("datasets/movies_hulu.csv");
    console.log(movies_hulu);

    const movies_prime = await d3.csv("datasets/movies_prime.csv");
    console.log(movies_prime);

    const movies_disney = await d3.csv("datasets/movies_disney.csv");
    console.log(movies_disney);

    const top20_genres = await d3.csv("datasets/top20_genres.csv");
    console.log(top20_genres);

    // graphing the bar chart that compares the number of movies across platforms

    const scale_barchart = d3.scaleLinear().domain([0, movies_prime.length]).range([10, allWidth-10]);

    const dict = {'Netflix':{'order':1, 'dataset':movies_netflix, 'color':'#E50914'}, 'Hulu':{'order':2, 'dataset':movies_hulu, 'color':'#1CE783'}, 'Prime Video':{'order':3, 'dataset':movies_prime, 'color':'#00A8E1'}, 'Disney+':{'order':4, 'dataset':movies_disney, 'color':'#000000'}}

    for (platform in dict){

      d3.select("#barchart")
        .append("rect")
        .attr("x", 0)
        .attr("y", (allHeight-100)/4*dict[platform]['order'])
        .attr("width", scale_barchart(dict[platform]['dataset'].length))
        .attr("height", 20)
        .attr("fill", dict[platform]['color'])
        .attr("opacity", 0.7);

      d3.select("#barchart")
        .append("text")
        .text(platform+": "+dict[platform]['dataset'].length.toString())
        .attr("x", 0)
        .attr("y", (allHeight-100)/4*dict[platform]['order']+40);

    }



    // d3.select("#barchart")
    //   .append("rect")
    //   .attr("x", 0)
    //   .attr("y", (allHeight-100)/4*2)
    //   .attr("width", scale_barchart(movies_hulu.length))
    //   .attr("height", 20)
    //   .attr("fill", "purple");
    //
    // d3.select("#barchart")
    //   .append("rect")
    //   .attr("x", 0)
    //   .attr("y", (allHeight-100)/4*3)
    //   .attr("width", scale_barchart(movies_prime.length))
    //   .attr("height", 20)
    //   .attr("fill", "purple");
    //
    // d3.select("#barchart")
    //   .append("rect")
    //   .attr("x", 0)
    //   .attr("y", (allHeight-100))
    //   .attr("width", scale_barchart(movies_disney.length))
    //   .attr("height", 20)
    //   .attr("fill", "purple");

  }

  requestData();

  </script>

</body>
</html>
